#!/bin/bash
#This script is in charge of extracting the packet statistics of the BS. It is saved in the file "StatisticsInfo_time" where "time" is the date when the script was executed. 

#we get the name of the folder for saving the files
folder=$1
filename1=logs_general
#log purposes
date --iso-8601=ns >> /home/upboard/Desktop/UpBoard-Code-and-Results/Results/"$folder"/"$filename1"
echo "The collection of Statistics has started" >> /home/upboard/Desktop/UpBoard-Code-and-Results/Results/"$folder"/"$filename1"
#We give a name to the file
x=$(date)
nameFile=StatisticsInfo_$x
#To initialize the file
echo "" >> /home/upboard/Desktop/UpBoard-Code-and-Results/Results/"$folder"/"$nameFile"
sudo chmod 777 /home/upboard/Desktop/UpBoard-Code-and-Results/Results/"$folder"/"$nameFile"


#While loop to save the statistics as fast as possible.
while true; do
wwan=$(netstat -i | grep -o  '\bww\w*') #We extract the name of the network interface that starts
#Format stuff
echo " " >> /home/upboard/Desktop/UpBoard-Code-and-Results/Results/"$folder"/"$nameFile" #blank space
#Other possibilities: ip-s link, netstat -s, netstat -i, nstat,

#Acquiring the packet statistics of the BS
date --iso-8601=ns >> /home/upboard/Desktop/UpBoard-Code-and-Results/Results/"$folder"/"$nameFile"
statistics=$(sudo ifconfig "$wwan")
echo "$statistics" >> /home/upboard/Desktop/UpBoard-Code-and-Results/Results/"$folder"/"$nameFile"
echo " " >> /home/upboard/Desktop/UpBoard-Code-and-Results/Results/"$folder"/"$nameFile" #blank space

done
